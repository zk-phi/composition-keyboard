# Composition 0.1

![co0](images/co0.jpeg)

![co1](images/co1.jpeg)

Choc V2 スイッチを採用した一体型・直交配列 40% キーボードです。 Choc V2 由来の薄さと、強めにつけた丸みが特徴的な可愛めのデザインになっています。透明アクリルで作るとよく光ります。

![co2](images/co2.jpeg)

また自分のキーボードではお馴染みになっている、内部の空洞を廃した積層ケースを採用しており、アクリルにしてはしっかりした打鍵感を実現しています。今回はスイッチの性質上プレートレスの設計になっており、 PCB とケースの間の空間がまったくないので、他の作品よりもやや硬めの打鍵感になります。 PCB とケースの間にゴムワッシャなどの緩衝材を入れても問題なく使えることを確認しているので、柔らかい打鍵感が好きな場合はなんちゃってガスケットマウントのように使うのもアリかもしれないです。

# 注意

Choc V2 は「MX 互換スイッチと同じキーキャップをはめることができるが、 MX 互換スイッチよりかなり薄い」という特殊なスイッチなので、若干トラップがあります。

## キーキャップ相性問題

キーキャップの形状によっては打鍵感が悪くなる、あるいは使い物にならない場合があります。

既知のものでは：

- GMK など (Cherry プロファイル)：底まで押すとキャップがスイッチに触れてしまい打鍵感が悪い

- RAMA GRID キーキャップ：底まで押すとキャップがスイッチにぴったりはまってしまい戻ってこない

まだ試していない組み合わせの中にも不具合の起こるパターンはあるかもしれないので、あらかじめご理解ください。私は DSA, XDA などと合わせて使用しています。

## トッププレート不採用

トッププレートをつけてしまうとキーキャップが確実に干渉してしまうため、このキーボードはトッププレートを省略した、ケースマウント形式を採用しています。

スイッチを基板に一個一個刺して半田付けしていくことになるので、ピチッとまっすぐ揃えて取り付けるのにコツが要ります（組み立てガイドの中でも解説しています）。

また基板をケースに直接固定する都合、基板がゆがんだ状態で組み立ててしまうとケース全体が歪んでしまうことがあります（アクリルは基板よりも柔らかいので、基板につられて歪んでしまう）。この対策についても組み立てガイドの中で解説していますので確認してください。

## ProMicro のレイアウトについて

このキーボードは ProMicro を採用しつつ Choc V2 の薄さも活かすため、 ProMicro がむき出しの状態で使用する前提の設計になっています（写真３枚目参照）。

「ProMicro が外れかけた状態で金属製の机に置く」など、無茶な使い方をするとショートの危険があるため、心配な方は

- あえてコンスルーを使わずに ProMicro を直接半田付けして、ゆるまないようにする
- 絶縁テープ等をあらかじめ貼っておく

など各自工夫して安全にお使いください（自分はあまり気にせず使っていますが、万が一があると悲しいので念のため）。

# 必要なもの

キット
- 基板
- トップフレーム 2mm x 1, 3mm x 1
- ミドルプレート (2mm)
- ボトムプレート上 (3mm)
- ボトムプレート下 (3mm) 2mm でも可

汎用部品
- キースイッチ, キーキャップ, ダイオード 1N4148w x41
- LED SK6812mini x56
- 2pin タクトスイッチ x1
- ProMicro + ピンヘッダまたはコンスルー
- M2 ねじ 14mm x13 (2mm ボトムプレートの場合は 13mm), 6mm x7
- M2 ナット x20
- ゴムクッション x6 以上

カスタマイズに使えそうな部品 (任意)
- ゴムワッシャ

# 組み立て
## Pro Micro にファームウェアを書き込んでおく

https://github.com/zk-phi/qmk_firmware に私の使っているキーマップがアップロードされています。

```terminal
make composition:phi:avrdude
```

## 基板の歪みを矯正

このキーボードは基板を直接ケースにねじ止めして一体化させる設計になっているので、基板の歪みが激しいと、最終的に完成するキーボード全体も歪んでしまうことがあります。

そこで、半田付けを始める前に、基板を損傷しない程度に軽く歪みを矯正しておくことをおすすめします。

## 基板に各パーツを実装

![pcb](images/pcb.png)

### ダイオードを実装

ダイオードはコの字の印がカソードです。

表面実装部品は、ガイドの印から大きくはみ出して取り付けてしまうと「ボトムプレート上」と干渉してケースが組めなくなってしまいますので、なるべく丁寧に位置を合わせてください。

実装を終えたら、ファームウェアを書き込んだ ProMicro をコンスルーで差し込み、スイッチの穴をショートすることでキー入力ができることを確認しておきましょう。

### LED を実装 (オプション)

LED はコの字の印が Vcc です。

LED の実装順は Pro Micro 側上段のバックライト (背面実装・赤) からスタートして Z 字に降りていき、下段まで行ったらアンダーグロー (表面実装・青) で折り返すように進みます。

![led](images/led.png)

ファームウェアを書き込んだ ProMicro をコンスルーで差し込み、逐次動作確認しながら進めていくのがオススメです。

### スイッチを実装

最後にスイッチを実装します。このキーボードはプレートレスの設計になっているので、トッププレートを挟まずにスイッチを半田付けしてしまって ok です。

Choc V2 は位置決めがやや難しいため、次のような手順で実装するのがおすすめです

1. ざっくり角度を決めて、マステなどで仮止めする
2. 回路に影響ない fix ピン (一つだけ下側に生えているピン) を最初に半田付けする
3. マステを剥がしてまっすぐついているか確認する。曲がっていたら修正する
4. 位置が確定したら残りの２つのピンも半田付けする

ProMicro の裏にくるスイッチは、足を切っておかないと ProMicro に干渉してしまう場合があります (個体差あり)。適宜ニッパなどで処理してください。ニッパを使用する際は切ったピンが飛んで行ってケガをしたりすることのないよう注意してください。

### Pro Micro の仕上げ

Pro Micro がゆるんでしまうのが不安な方は、 Pro Micro を基板に半田付けします。

また「ボトムプレート下」に 3mm ではなく 2mm のプレートを使用する場合は、コンスルーの足をカットしておきます。正しくない使い方かもしれないですが、 1mm 薄く組むことができるので興味のある方は自己責任でチャレンジしてみてください。

## 基板とボトムプレート上を合体

![bottom](images/bottom.png)

「ボトムプレート上」と基板を短い方のネジで連結します。

基板とボトムプレートの間にゴムワッシャなどの緩衝材を挟んで、なんちゃってガスケットマウントのようにするのもアリだと思います（問題なく使えました）。

## ケースを組み立て

![case](images/case.png)

下から

- ボトムプレート下
- 基板＋ボトムプレート上
- ミドルフレーム
- トップフレーム (3mm)
- トップフレーム (3mm)

の順に重ね、長い方のネジで連結します。

キーキャップをはめて、ゴムクッションを貼り付ければ完成です。ゴムクッションを増やした方が剛性感が得られますが、ケースにたわみが出た時にガタつきを起こしてしまいます。このキーボードは薄く、また基板がケースと一体になっておりたわみやすいので、私は四隅だけにつけて使用しています。
